Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   472    119.0 MiB    119.0 MiB           1   @profile(stream=fp)
   473                                         def pick_month(browser,waits,Action,month):
   474                                             '''checks for month of request booking and clicks it'''
   475    119.0 MiB      0.0 MiB           1       siteEntryMonthText=[]
   476    119.0 MiB      0.0 MiB           1       flag = True
   477    119.0 MiB      0.0 MiB           1       date_list = month.split(' ')
   478    119.0 MiB      0.0 MiB           1       year = date_list[1]
   479    119.0 MiB      0.0 MiB           1       flag = False
   480    119.0 MiB      0.0 MiB           1       siteEntryMonthNext = browser.find_element(By.ID,'nextYearButton')
   481    119.0 MiB      0.0 MiB           1       siteEntryMonth = browser.find_element(By.CSS_SELECTOR,'#monthDropdownPicker').click()
   482    119.0 MiB      0.0 MiB           1       while flag == False:
   483    119.0 MiB      0.0 MiB           1           try:
   484    119.0 MiB      0.0 MiB           1               x = browser.find_element(By.CLASS_NAME,'mat-calendar-body-label').text
   485    119.0 MiB      0.0 MiB           1               if x != date_list[1]:
   486                                                          siteEntryMonthNext.click()
   487    119.0 MiB      0.0 MiB           1               elif x == date_list[1]:
   488    119.0 MiB      0.0 MiB           1                   flag = True
   489    119.0 MiB      0.0 MiB           1                   r=date_list[0]
   490    119.0 MiB      0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.XPATH,"//div[contains(text(),'%s')]" % r))).click()
   491    119.0 MiB      0.0 MiB           1                   break
   492                                                 except:
   493                                                     pass
   494    119.0 MiB      0.0 MiB           1       return True


Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   462    119.0 MiB    119.0 MiB           1   @profile(stream=fp)
   463                                         def escape(Action):
   464                                             '''escapes some click function'''
   465    119.0 MiB      0.0 MiB           1       Action.key_down(Keys.ESCAPE).perform()
   466    119.0 MiB      0.0 MiB           1       Action.key_up(Keys.ESCAPE).perform()


Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   495    119.0 MiB    119.0 MiB           1   @profile(stream=fp)
   496                                         def pick_day(browser,waits,Action,b_info):
   497                                             '''checks for day of request bookinf and clicks it'''
   498    119.0 MiB      0.0 MiB           1       flag = True
   499    119.0 MiB      0.0 MiB           1       siteEntryDateText=[]
   500                                             #scans the days until it finds the day enteredn much like the month
   501    119.0 MiB      0.0 MiB           2       while flag == True :
   502    119.0 MiB      0.0 MiB           1           siteEntryDateText = browser.find_elements(By.CSS_SELECTOR,'.mat-calendar-body > tr > td')
   503    119.0 MiB      0.0 MiB           1           waits.until(EC.presence_of_element_located((By.CSS_SELECTOR,'.mat-calendar-body > tr > td')))
   504    119.0 MiB      0.0 MiB           1           counter = 0
   505    119.0 MiB      0.0 MiB          10           for date in siteEntryDateText:
   506    119.0 MiB      0.0 MiB          10               counter+=1
   507    119.0 MiB      0.0 MiB          10               if counter > 31:
   508                                                         flag = False
   509                                                         return False
   510    119.0 MiB      0.0 MiB          10               if(date.text == b_info.arrival_day):
   511    119.0 MiB      0.0 MiB           1                   date.click()
   512    119.0 MiB      0.0 MiB           1                   flag = False
   513    119.0 MiB      0.0 MiB           1                   break
   514                                                     
   515    119.0 MiB      0.0 MiB           1       escape(Action)
   516    119.0 MiB      0.0 MiB           1       sleep(0.5)
   517    119.0 MiB      0.0 MiB           1       return True


Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   467    119.0 MiB    119.0 MiB           1   @profile(stream=fp)
   468                                         def backspace(Action):
   469                                             '''deletes some inpits'''
   470    119.0 MiB      0.0 MiB           1       Action.key_down(Keys.BACKSPACE).perform()
   471    119.0 MiB      0.0 MiB           1       Action.key_up(Keys.BACKSPACE).perform()


Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   462    119.0 MiB    119.0 MiB           1   @profile(stream=fp)
   463                                         def escape(Action):
   464                                             '''escapes some click function'''
   465    119.0 MiB      0.0 MiB           1       Action.key_down(Keys.ESCAPE).perform()
   466    119.0 MiB      0.0 MiB           1       Action.key_up(Keys.ESCAPE).perform()


Filename: C:\Users\cfarb\OneDrive\Desktop\WS5\park\booked.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   727    118.4 MiB    118.4 MiB           1   @profile(stream=fp)
   728                                         def reservation(browser,waits,Action,u_info,b_info,s_info):
   729    118.4 MiB      0.0 MiB           1           @profile(stream=fp)
   730    118.4 MiB      0.0 MiB           1           def mytimer():
   731                                                     print('timer start')
   732                                                     sleep(60)
   733                                                     print('browser closing')
   734                                                     browser.quit()
   735    118.4 MiB      0.0 MiB           1           try:
   736    118.4 MiB      0.0 MiB           1               print('thread start')
   737    118.4 MiB      0.0 MiB           1               x = threading.Thread(target=mytimer)
   738    118.5 MiB      0.0 MiB           1               x.start()
   739                                                 except:
   740                                                      print('could not thread')
   741    118.5 MiB      0.0 MiB           1           browser.implicitly_wait(5)
   742    118.5 MiB      0.0 MiB           3           doc_ready =wait(browser, 20).until(lambda browser: browser.execute_script('return document.readyState') == 'complete')
   743    118.7 MiB      0.2 MiB           1           web = browser.get('https://camping.bcparks.ca/')
   744                                         
   745    118.7 MiB      0.0 MiB           1           flag = True
   746    118.7 MiB      0.0 MiB           1           counter = 0
   747    118.7 MiB      0.0 MiB           1           counter = 0
   748    118.7 MiB      0.0 MiB           1           '''
   749                                                 while flag:
   750                                                     counter+=1
   751                                                     b= b_info.site_type
   752                                                     try:
   753                                                         waits.until(EC.presence_of_element_located((By.XPATH,"//div[contains(@id,'tab-group-') and contains(text(),'%s')]" % b))).click()
   754                                                         flag = False
   755                                                     except:
   756                                                         print('Dont care')
   757                                                     if counter > 10:
   758                                                         browser.quit()
   759                                                 '''
   760    118.7 MiB      0.0 MiB           1           month = str(b_info.arrival_date)
   761    118.7 MiB      0.0 MiB           1           date_list = month.split('-')
   762    118.7 MiB      0.0 MiB           1           arr_mon = str(date_list[1])
   763    118.7 MiB      0.0 MiB           1           months = {'01':'JAN','02':'FEB','03':'MAR','04':'APR','05':'MAY','06':'JUN','07':'JUL','08':'AUG','09':'SEPT','10':'OCT','11':'NOV','12':'DEC'} 
   764    118.7 MiB      0.0 MiB           1           if arr_mon in months:
   765    118.7 MiB      0.0 MiB           1               month = months[arr_mon]
   766    118.7 MiB      0.0 MiB           1               month = month + ' '+date_list[0]
   767    118.7 MiB      0.0 MiB           1               print('month ',month)
   768    118.7 MiB      0.0 MiB           1           d2 = datetime(int(date_list[0]),int(date_list[1]),int(date_list[2]),6,59,59,59)
   769                                                 #consent
   770    118.7 MiB      0.0 MiB           1           try:
   771    118.8 MiB      0.1 MiB           1               waits.until(EC.visibility_of_element_located((By.ID,'consentButton')))
   772    118.9 MiB      0.1 MiB           1               waits.until(EC.element_to_be_clickable((By.ID,'consentButton'))).click()
   773                                                 except:
   774                                                     pass
   775                                                 
   776                                                 #park
   777    118.9 MiB      0.0 MiB           1           try:
   778    118.9 MiB      0.0 MiB           1                   found = browser.find_element(By.ID,'park-field').click()
   779    118.9 MiB      0.0 MiB           1                   list_box=[]
   780    118.9 MiB      0.0 MiB           1                   list_box = browser.find_elements(By.CLASS_NAME,'mat-option-text')
   781    119.0 MiB      0.0 MiB          77                   for text in list_box:
   782    119.0 MiB      0.0 MiB          77                       print(text.text)
   783    119.0 MiB      0.1 MiB          77                       if str(text.text) == b_info.park:
   784    119.0 MiB      0.0 MiB           1                           text.click()
   785    119.0 MiB      0.0 MiB           1                           break
   786                                            
   787                                                 except:
   788                                                         end = time.time()
   789                                                         s1 = False
   790                                                         x = 'located park'
   791                                                         return False,end,s1,x
   792                                         
   793    119.0 MiB      0.0 MiB           1           waits.until(EC.presence_of_element_located((By.ID,'mat-date-range-input-0')))
   794    119.0 MiB      0.0 MiB           1           element = waits.until(EC.presence_of_element_located((By.CSS_SELECTOR,'.mat-date-range-input-start-wrapper'))).click()
   795                                                 #pick month
   796    119.0 MiB      0.0 MiB           1           try:
   797    119.0 MiB      0.0 MiB           1                   month_picked = pick_month(browser,waits,Action,month)
   798    119.0 MiB      0.0 MiB           1                   if month_picked == False:
   799                                                             end = time.time()
   800                                                             s1 = False
   801                                                             x = 'pick month'
   802                                                             return False,end,s1,x
   803                                         
   804                                                 except:
   805                                                         end = time.time()
   806                                                         s1 = False
   807                                                         return False,end,s1,'pick month'
   808                                                     #pick day
   809    119.0 MiB      0.0 MiB           1           try:
   810    119.0 MiB      0.0 MiB           1                   day_picked = pick_day(browser,waits,Action,b_info)
   811    119.0 MiB      0.0 MiB           1                   if day_picked == False:
   812                                                             end = time.time()
   813                                                             s1 = False
   814                                                             x = 'pick day'
   815                                                             return False,end,s1,x
   816                                                 except:
   817                                                         end = time.time()
   818                                                         s1 = False
   819                                                         x = 'pick day'
   820                                                         return False,end,s1,x
   821                                         
   822                                                     #Nights
   823    119.0 MiB      0.0 MiB           1           try:
   824    119.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   825    119.0 MiB      0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.ID,'nightsTab'))).click()
   826    119.0 MiB      0.0 MiB           1                   backspace(Action)
   827    119.0 MiB      0.0 MiB           1                   night = waits.until(EC.presence_of_element_located((By.ID,'nights-field')))
   828    119.0 MiB      0.0 MiB           1                   type_speed(night,b_info.nights)
   829                                         
   830    119.0 MiB      0.0 MiB           1                   sleep(2)
   831    119.0 MiB      0.0 MiB           1                   escape(Action)
   832                                                 except:
   833                                                         end = time.time()
   834                                                         s1 = False
   835                                                         x = 'nights'
   836                                                         return False,end,s1,x
   837                                                     #EQUIPMENT
   838    119.0 MiB      0.0 MiB           1           try:
   839    119.0 MiB      0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.ID,'equipment-field'))).click()
   840    119.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   841                                                 except:
   842                                                         end = time.time()
   843                                                         s1 = False
   844                                                         x = 'camp equiptment field'
   845                                                         return False,end,s1,x
   846                                                     
   847    119.0 MiB      0.0 MiB           1           try:
   848    119.0 MiB      0.0 MiB           1                   found = waits.until(EC.presence_of_all_elements_located((By.CLASS_NAME,'mat-option-text')))
   849    119.0 MiB      0.0 MiB           1                   list_box=[]
   850    119.0 MiB      0.0 MiB           1                   list_box = browser.find_elements(By.CLASS_NAME,'mat-option-text')
   851    119.0 MiB      0.0 MiB           2                   for text in list_box:
   852    119.0 MiB      0.0 MiB           2                       if str(text.text) == b_info.equiptment:
   853    119.0 MiB      0.0 MiB           1                           text.click() 
   854    119.0 MiB      0.0 MiB           1                           break
   855                                                         
   856    119.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   857    119.0 MiB      0.0 MiB           1                   sleep(1)
   858    119.0 MiB      0.0 MiB           1                   n= 5
   859                                                      
   860    119.0 MiB      0.0 MiB           1                   while n > 0:
   861    119.0 MiB      0.0 MiB           1                       print(n)
   862    119.0 MiB      0.0 MiB           1                       n-=1
   863    119.0 MiB      0.0 MiB           1                       try:
   864    119.0 MiB      0.0 MiB           1                           browser.find_element(By.ID,'actionSearch').click()
   865    119.0 MiB      0.0 MiB           1                           break
   866                                                             except:
   867                                                                 pass
   868                                              
   869                                                 except:
   870                                                         
   871                                                         end = time.time()
   872                                                         s1 = False
   873                                                         x= 'action search'
   874                                                         return False,end,s1,x
   875                                                     #listview
   876    119.0 MiB      0.0 MiB           1           try:
   877    119.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   878    119.1 MiB      0.1 MiB           1                   waits.until(EC.presence_of_element_located((By.CSS_SELECTOR,'#list-view-button-button > span:nth-child(1)')))
   879    119.1 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   880    119.1 MiB     -0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.ID,'mat-tab-label-1-1')))
   881    119.1 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   882                                                 except:
   883                                                         end = time.time()
   884                                                         s1 = False
   885                                                         x ='list view pre-spin'
   886                                                         return False,end,s1,x
   887                                               
   888                                                     #spinning overlay
   889    119.1 MiB      0.0 MiB           1           try:
   890    119.1 MiB      0.0 MiB           1               waits.until(EC.invisibility_of_element((By.CLASS_NAME,'loading-spinner overlay ng-star-inserted')))
   891    119.1 MiB      0.0 MiB           1           except:
   892    119.1 MiB      0.0 MiB           1               end = time.time()
   893    119.1 MiB      0.0 MiB           1               s1 = False
   894    119.1 MiB      0.0 MiB           1               x ='loading spinner post spin'
   895    119.1 MiB      0.0 MiB           1               return False,end,s1,x
   896                                                 
   897                                                     #campgroundlist
   898                                                 try:
   899                                                     waits.until(EC.visibility_of_element_located((By.ID,'mat-tab-label-1-1')))
   900                                                     browser.implicitly_wait(5)
   901                                                     waits.until(EC.element_to_be_clickable((By.ID,'list-view-button'))).click()
   902                                                 
   903                                                
   904                                                 except:
   905                                                     end = time.time()
   906                                                     s1 = False
   907                                                     x ='list view button'
   908                                                     return False,end,s1,x
   909                                         
   910                                                     #second camp 
   911                                                 try:
   912                                                     b = str(b_info.campground)
   913                                                     b = b.lstrip().rstrip()
   914                                                     waits.until(EC.presence_of_element_located((By.XPATH,"//h3[contains(text(),'%s')]" % b))).click()   
   915                                         
   916                                         
   917                                                 except:
   918                                                     pass
   919                                                 try:
   920                                                      b = str(b_info.inner_campground)
   921                                                      b = b.lstrip().rstrip()
   922                                                      x = browser.find_element(By.XPATH,"//h3[contains(text(),'%s')]" % b)
   923                                                      x.click()
   924                                                 except Exception:
   925                                                      pass
   926                                         
   927                                         
   928                                                     #looking for site
   929                                                 waits.until(EC.presence_of_all_elements_located((By.CSS_SELECTOR,'.mat-accordion')))
   930                                                 site_found = False
   931                                                 found_counter = 0
   932                                         
   933                                                 while site_found == False:
   934                                                     try:
   935                                             
   936                                                         found_counter+=1
   937                                                         sites = browser.find_elements(By.XPATH,"//h3[contains(@id,'resource-name-')]")
   938                                                         for i in sites:
   939                                                                 print(i.text)
   940                                                                 if b_info.site in i.text:
   941                                                                     i.click()
   942                                                                     r = 'Reserve'
   943                                                                     sleep(2)
   944                                                                     site_found = True
                                   
   847    111.0 MiB      0.0 MiB           1           try:
   848    111.0 MiB      0.0 MiB           1                   found = waits.until(EC.presence_of_all_elements_located((By.CLASS_NAME,'mat-option-text')))
   849    111.0 MiB      0.0 MiB           1                   list_box=[]
   850    111.0 MiB      0.0 MiB           1                   list_box = browser.find_elements(By.CLASS_NAME,'mat-option-text')
   851    111.0 MiB      0.0 MiB           2                   for text in list_box:
   852    111.0 MiB     -0.0 MiB           2                       if str(text.text) == b_info.equiptment:
   853    110.9 MiB     -0.0 MiB           1                           text.click() 
   854    110.9 MiB      0.0 MiB           1                           break
   855                                                         
   856    110.9 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   857    110.9 MiB      0.0 MiB           1                   sleep(1)
   858    110.9 MiB      0.0 MiB           1                   n= 5
   859                                                      
   860    110.9 MiB      0.0 MiB           1                   while n > 0:
   861    110.9 MiB      0.0 MiB           1                       print(n)
   862    110.9 MiB      0.0 MiB           1                       n-=1
   863    110.9 MiB      0.0 MiB           1                       try:
   864    110.9 MiB      0.0 MiB           1                           browser.find_element(By.ID,'actionSearch').click()
   865    110.9 MiB      0.0 MiB           1                           break
   866                                                             except:
   867                                                                 pass
   868                                              
   869                                                 except:
   870                                                         
   871                                                         end = time.time()
   872                                                         s1 = False
   873                                                         x= 'action search'
   874                                                         return False,end,s1,x
   875                                                     #listview
   876    110.9 MiB      0.0 MiB           1           try:
   877    110.9 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   878    110.9 MiB      0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.CSS_SELECTOR,'#list-view-button-button > span:nth-child(1)')))
   879    111.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   880    111.0 MiB      0.0 MiB           1                   waits.until(EC.presence_of_element_located((By.ID,'mat-tab-label-1-1')))
   881    111.0 MiB      0.0 MiB           1                   browser.implicitly_wait(5)
   882                                                 except:
   883                                                         end = time.time()
   884                                                         s1 = False
   885                                                         x ='list view pre-spin'
   886                                                         return False,end,s1,x
   887                                               
   888                                                     #spinning overlay
   889    111.0 MiB      0.0 MiB           1           try:
   890    111.0 MiB      0.0 MiB           1               waits.until(EC.invisibility_of_element((By.CLASS_NAME,'loading-spinner overlay ng-star-inserted')))
   891                                                 except:
   892                                                     end = time.time()
   893                                                     s1 = False
   894                                                     x ='loading spinner post spin'
   895                                                     return False,end,s1,x
   896                                                 
   897                                                     #campgroundlist
   898    111.0 MiB      0.0 MiB           1           try:
   899    111.0 MiB      0.0 MiB           1               waits.until(EC.visibility_of_element_located((By.ID,'mat-tab-label-1-1')))
   900    111.0 MiB      0.0 MiB           1               browser.implicitly_wait(5)
   901    111.0 MiB      0.0 MiB           1               waits.until(EC.element_to_be_clickable((By.ID,'list-view-button'))).click()
   902                                                 
   903                                                
   904                                                 except:
   905                                                     end = time.time()
   906                                                     s1 = False
   907                                                     x ='list view button'
   908                                                     return False,end,s1,x
   909                                         
   910                                                     #second camp 
   911    111.0 MiB      0.0 MiB           1           try:
   912    111.0 MiB      0.0 MiB           1               b = str(b_info.campground)
   913    111.0 MiB      0.0 MiB           1               b = b.lstrip().rstrip()
   914    111.0 MiB      0.0 MiB           1               waits.until(EC.presence_of_element_located((By.XPATH,"//h3[contains(text(),'%s')]" % b))).click()   
   915                                         
   916                                         
   917                                                 except:
   918                                                     pass
   919    111.0 MiB      0.0 MiB           1           try:
   920    111.0 MiB      0.0 MiB           1                b = str(b_info.inner_campground)
   921    111.0 MiB      0.0 MiB           1                b = b.lstrip().rstrip()
   922    111.0 MiB      0.0 MiB           1                x = browser.find_element(By.XPATH,"//h3[contains(text(),'%s')]" % b)
   923                                                      x.click()
   924    111.0 MiB      0.0 MiB           1           except Exception:
   925    111.0 MiB      0.0 MiB           1                pass
   926                                         
   927                                         
   928                                                     #looking for site
   929    111.0 MiB      0.0 MiB           1           waits.until(EC.presence_of_all_elements_located((By.CSS_SELECTOR,'.mat-accordion')))
   930    111.0 MiB      0.0 MiB           1           site_found = False
   931    111.0 MiB      0.0 MiB           1           found_counter = 0
   932                                         
   933    111.0 MiB      0.0 MiB           2           while site_found == False:
   934    111.0 MiB      0.0 MiB           1               try:
   935                                             
   936    111.0 MiB      0.0 MiB           1                   found_counter+=1
   937    111.0 MiB      0.0 MiB           1                   sites = browser.find_elements(By.XPATH,"//h3[contains(@id,'resource-name-')]")
   938    111.0 MiB      0.0 MiB           4                   for i in sites:
   939    111.0 MiB      0.0 MiB           4                           print(i.text)
   940    111.0 MiB      0.0 MiB           4                           if b_info.site in i.text:
   941    111.0 MiB      0.0 MiB           1                               i.click()
   942    111.0 MiB      0.0 MiB           1                               r = 'Reserve'
   943    111.0 MiB      0.0 MiB           1                               sleep(2)
   944    111.0 MiB      0.0 MiB           1                               site_found = True
